<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h1 id="dds-project-1-beers-and-breweries">DDS Project 1: Beers and Breweries</h1> <h4 id="stephanie-duarte-and-catherine-ticzon">Stephanie Duarte and Catherine Ticzon</h4> <h4 id="2023-06-19">2023-06-19</h4> <h2 id="introduction">Introduction</h2> <p>The purpose of this document is to share the results and code for an initial data exploration analysis of the following data sets: beers and breweries.</p> <p>Below are the questions addressed in this file:</p> <ol> <li>How many breweries are in each state?</li> <li>Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.</li> <li>Address the missing values in each column.</li> <li>Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.</li> <li>Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?</li> <li>Comment on the summary statistics and distribution of the ABV variable.</li> <li>Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.</li> <li>Budweiser would also like to investigate the difference with respect to IBU and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with “Ale” in its name other than IPA).</li> </ol> <p># Load data sets</p> <p>beers &lt;- read.csv(“C:\Users\48103982\Documents\MSDS\6306 Doing Data Science\Project 1\Beers.csv”, header=TRUE)</p> <p>breweries &lt;- read.csv(“C:\Users\48103982\Documents\MSDS\6306 Doing Data Science\Project 1\Breweries.csv”, header=TRUE)</p> <p># Remove white space from data frame</p> <p>breweries2 &lt;- breweries %&gt;% mutate(across(where(is.character), str_trim))</p> <p># Create lookup to add full state name</p> <p>lookup &lt;- data.frame(abb = state.abb, State = state.name)</p> <p>colnames(breweries2)[4] = “abb”</p> <p>breweriesClean &lt;- merge(breweries2, lookup, by.x = “abb”, by.y = “abb”, all.x = TRUE, all.y = FALSE)</p> <h2 id="1-how-many-breweries-are-in-each-state">1. How many breweries are in each state?</h2> <p>The code used to answer this questions first groups the breweries by state and that was stored as its own variable. A bar graph and a heatmap are used to visualize the information. The variable that stores the states and the corresponding number of breweries is printed out to see a list of all values.</p> <p><strong>Summary:</strong></p> <ul> <li>Total of 558 breweries across the U.S. <ul> <li>3 states with 30 or more breweries</li> <li>7 states with 20-29 breweries</li> <li>9 states with 10-19 breweries</li> <li>31 states with 10 breweries or less</li> </ul> </li> <li>Colorado has the most number of breweries (47)</li> </ul> <p>numberOfBreweries &lt;- count(group_by(breweriesClean, State))</p> <p># write_csv(numberOfBreweries, path=”C:\Users\48103982\Documents\MSDS\6306 Doing Data Science\Project 1\numberOfBreweries.csv”)</p> <p># Create a plot with number of breweries by state</p> <p>ggplot(data=breweries, mapping = aes(x=State)) +</p> <p>` `geom_bar() +</p> <p>` `theme(axis.text.x = element_text(angle=90),</p> <p>` `axis.title.x = element_blank(),</p> <p>` `axis.title.y = element_blank()) +</p> <p>` `labs(title=”Number of Breweries in Each State”)</p> <p># Print out values</p> <p>print(numberOfBreweries, n=51)</p> <p>## # A tibble: 51 × 2</p> <p>## # Groups: State [51]</p> <p>## State n</p> <p>## <chr> <int></int></chr></p> <p>## 1 Alabama 3</p> <p>## 2 Alaska 7</p> <p>## 3 Arizona 11</p> <p>## 4 Arkansas 2</p> <p>## 5 California 39</p> <p>## 6 Colorado 47</p> <p>## 7 Connecticut 8</p> <p>## 8 Delaware 2</p> <p>## 9 Florida 15</p> <p>## 10 Georgia 7</p> <p>## 11 Hawaii 4</p> <p>## 12 Idaho 5</p> <p>## 13 Illinois 18</p> <p>## 14 Indiana 22</p> <p>## 15 Iowa 5</p> <p>## 16 Kansas 3</p> <p>## 17 Kentucky 4</p> <p>## 18 Louisiana 5</p> <p>## 19 Maine 9</p> <p>## 20 Maryland 7</p> <p>## 21 Massachusetts 23</p> <p>## 22 Michigan 32</p> <p>## 23 Minnesota 12</p> <p>## 24 Mississippi 2</p> <p>## 25 Missouri 9</p> <p>## 26 Montana 9</p> <p>## 27 Nebraska 5</p> <p>## 28 Nevada 2</p> <p>## 29 New Hampshire 3</p> <p>## 30 New Jersey 3</p> <p>## 31 New Mexico 4</p> <p>## 32 New York 16</p> <p>## 33 North Carolina 19</p> <p>## 34 North Dakota 1</p> <p>## 35 Ohio 15</p> <p>## 36 Oklahoma 6</p> <p>## 37 Oregon 29</p> <p>## 38 Pennsylvania 25</p> <p>## 39 Rhode Island 5</p> <p>## 40 South Carolina 4</p> <p>## 41 South Dakota 1</p> <p>## 42 Tennessee 3</p> <p>## 43 Texas 28</p> <p>## 44 Utah 4</p> <p>## 45 Vermont 10</p> <p>## 46 Virginia 16</p> <p>## 47 Washington 23</p> <p>## 48 West Virginia 1</p> <p>## 49 Wisconsin 20</p> <p>## 50 Wyoming 4</p> <p>## 51 <na> 1</na></p> <p>sum(numberOfBreweries$n)</p> <p>## [1] 558</p> <h3 id="create-a-heatmap-with-data">Create a heatmap with data</h3> <p>numberOfBreweries$region &lt;- tolower(numberOfBreweries$State)</p> <p>states &lt;- map_data(“state”)</p> <p>map.df &lt;- merge(states,numberOfBreweries, by=”region”, all.x=T)</p> <p>map.df &lt;- map.df[order(map.df$order),]</p> <p>ggplot(map.df, aes(x=long,y=lat,group=group))+</p> <p>` `geom_polygon(aes(fill=n)) +</p> <p>` `geom_path() +</p> <p>` `scale_fill_continuous(low = “orange”,</p> <p>` `high = “darkblue”,</p> <p>` `na.value = “grey50”) +</p> <p>` `ggtitle(“Number of Breweries in Each State “) +</p> <p>` `theme(axis.text.x = element_blank(),</p> <p>` `axis.text.y = element_blank(),</p> <p>` `axis.title.x = element_blank(),</p> <p>` `axis.title.y = element_blank(),</p> <p>` `panel.border = element_blank(),</p> <p>` `panel.grid.major = element_blank(),</p> <p>` `panel.grid.minor = element_blank(),</p> <p>` `panel.background = element_blank(),</p> <p>` `axis.ticks = element_blank()) +</p> <p>` `labs(fill = “Number of Breweries”) +</p> <p>coord_map()</p> <h2 id="2-merge-beer-data-with-the-breweries-data-print-the-first-6-observations-and-the-last-six-observations-to-check-the-merged-file">2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.</h2> <p>Merging the beer and breweries data sets into one file is necessary to answer the remaining questions. Data sets were merged by brewery ID numbers.</p> <p># Rename brewery ID column so they match in both data sets before joining</p> <p>colnames(breweriesClean)[2] &lt;- “Brewery_id”</p> <p>bb &lt;- full_join(beers, breweriesClean, by = “Brewery_id”) %&gt;%</p> <p>` `rename(“Beer” = “Name.x”,</p> <p>` `“Brewery” = “Name.y”)</p> <p>bb$ABV = as.numeric(bb$ABV)</p> <p>head(bb, 6)</p> <p>## Beer Beer_ID ABV IBU Brewery_id</p> <p>## 1 Pub Beer 1436 0.050 NA 409</p> <p>## 2 Devil’s Cup 2265 0.066 NA 178</p> <p>## 3 Rise of the Phoenix 2264 0.071 NA 178</p> <p>## 4 Sinister 2263 0.090 NA 178</p> <p>## 5 Sex and Candy 2262 0.075 NA 178</p> <p>## 6 Black Exodus 2261 0.077 NA 178</p> <p>## Style Ounces abb Brewery City</p> <p>## 1 American Pale Lager 12 OR 10 Barrel Brewing Company Bend</p> <p>## 2 American Pale Ale (APA) 12 IN 18th Street Brewery Gary</p> <p>## 3 American IPA 12 IN 18th Street Brewery Gary</p> <p>## 4 American Double / Imperial IPA 12 IN 18th Street Brewery Gary</p> <p>## 5 American IPA 12 IN 18th Street Brewery Gary</p> <p>## 6 Oatmeal Stout 12 IN 18th Street Brewery Gary</p> <p>## State</p> <p>## 1 Oregon</p> <p>## 2 Indiana</p> <p>## 3 Indiana</p> <p>## 4 Indiana</p> <p>## 5 Indiana</p> <p>## 6 Indiana</p> <p>tail(bb, 6)</p> <p>## Beer Beer_ID ABV IBU Brewery_id</p> <p>## 2405 Rocky Mountain Oyster Stout 1035 0.075 NA 425</p> <p>## 2406 Belgorado 928 0.067 45 425</p> <p>## 2407 Rail Yard Ale 807 0.052 NA 425</p> <p>## 2408 B3K Black Lager 620 0.055 NA 425</p> <p>## 2409 Silverback Pale Ale 145 0.055 40 425</p> <p>## 2410 Rail Yard Ale (2009) 84 0.052 NA 425</p> <p>## Style Ounces abb Brewery City</p> <p>## 2405 American Stout 12 CO Wynkoop Brewing Company Denver</p> <p>## 2406 Belgian IPA 12 CO Wynkoop Brewing Company Denver</p> <p>## 2407 American Amber / Red Ale 12 CO Wynkoop Brewing Company Denver</p> <p>## 2408 Schwarzbier 12 CO Wynkoop Brewing Company Denver</p> <p>## 2409 American Pale Ale (APA) 12 CO Wynkoop Brewing Company Denver</p> <p>## 2410 American Amber / Red Ale 12 CO Wynkoop Brewing Company Denver</p> <p>## State</p> <p>## 2405 Colorado</p> <p>## 2406 Colorado</p> <p>## 2407 Colorado</p> <p>## 2408 Colorado</p> <p>## 2409 Colorado</p> <p>## 2410 Colorado</p> <h2 id="3-address-the-missing-values-in-each-column">3. Address the missing values in each column</h2> <p>The code used to answer this question first identifies all instances of missing data. Then, code was written to summarize the two methods used to address the missing data. A barplot and boxplots are used to visualize the data.</p> <p><strong>Summary:</strong></p> <ul> <li>44.2% (n=1,072) of data had missing values <ul> <li>2.5% (n=62)of data had missing values in the ABV column</li> <li>41.7% (n=1,005) of data had missing values in IBU column</li> </ul> </li> </ul> <p>Two methods used to address the missing data:</p> <ol> <li>Eliminate missing data <ol> <li>Minimum 2.7%</li> <li>Median: 5.7%</li> <li>Mean: 5.99%</li> <li>Maximum: 12.5%</li> </ol> </li> <li>Replace the missing data with the average <ol> <li>Minimum: 0.1%</li> <li>Median: 5.6%</li> <li>Mean: 5.977%</li> <li>Maximum: 12.8%</li> </ol> </li> </ol> <p>While there are slight differences (less than 0.3%) between the median, mean, and maximum, the largest resulting difference between the two methods was related to the minimum. By eliminating the missing data, the minimum is 2.7; by replacing the missing data with the average, the minimum is 0.1%.</p> <p>summary(bb)</p> <p>## Beer Beer_ID ABV IBU</p> <p>## Length:2410 Min. : 1.0 Min. :0.00100 Min. : 4.00</p> <p>## Class :character 1st Qu.: 808.2 1st Qu.:0.05000 1st Qu.: 21.00</p> <p>## Mode :character Median :1453.5 Median :0.05600 Median : 35.00</p> <p>## Mean :1431.1 Mean :0.05977 Mean : 42.71</p> <p>## 3rd Qu.:2075.8 3rd Qu.:0.06700 3rd Qu.: 64.00</p> <p>## Max. :2692.0 Max. :0.12800 Max. :138.00</p> <p>## NA’s :62 NA’s :1005</p> <p>## Brewery_id Style Ounces abb</p> <p>## Min. : 1.0 Length:2410 Min. : 8.40 Length:2410</p> <p>## 1st Qu.: 94.0 Class :character 1st Qu.:12.00 Class :character</p> <p>## Median :206.0 Mode :character Median :12.00 Mode :character</p> <p>## Mean :232.7 Mean :13.59</p> <p>## 3rd Qu.:367.0 3rd Qu.:16.00</p> <p>## Max. :558.0 Max. :32.00</p> <p>##</p> <p>## Brewery City State</p> <p>## Length:2410 Length:2410 Length:2410</p> <p>## Class :character Class :character Class :character</p> <p>## Mode :character Mode :character Mode :character</p> <p>##</p> <p>##</p> <p>##</p> <p>##</p> <p># Barplot of missing data</p> <p>sum(is.na(bb))</p> <p>## [1] 1075</p> <p>df&lt;- data.frame(table(is.na(bb)))</p> <p>barplot(df$Freq , main = “Total Missing Values”,</p> <p>` `xlab = “Missing Data”, ylab = “Frequency”,</p> <p>` `names.arg = c(“FALSE”,”TRUE”),</p> <p>` `col = c(“lightblue”,”lightgreen”))</p> <p>legend(“topright”,</p> <p>` `c(“Non-Missing Values”,”Missing Values”),</p> <p>` `fill = c(“lightblue”,”lightgreen”), cex = 0.75)</p> <p># Method 1: Eliminate missing data</p> <p>completed_beer &lt;- bb[complete.cases(bb),] #bb with only complete records</p> <p>dim(completed_beer)</p> <p>## [1] 1401 11</p> <p># Create Boxplot</p> <p>summary(completed_beer$ABV)</p> <p>## Min. 1st Qu. Median Mean 3rd Qu. Max.</p> <p>## 0.0270 0.0500 0.0570 0.0599 0.0680 0.1250</p> <p>ggplot(data = completed_beer, mapping = aes(x = ABV)) +</p> <p>` `geom_boxplot(fill = “red”, width=.1) +</p> <p>` `labs(x = “ABV”, title = “ABV Distribution”) +</p> <p>` `theme(axis.text.y=element_text(colour=”white”))</p> <p>#Method 2: replace missing data with average</p> <p>average_beer &lt;- bb</p> <p>averageABV &lt;- mean(average_beer$ABV, na.rm = TRUE)</p> <p>averageIBU &lt;- mean(average_beer$IBU, na.rm = TRUE)</p> <p>average_beer$IBU[is.na(average_beer$IBU)]&lt;- averageIBU</p> <p>average_beer$ABV[is.na(average_beer$ABV)]&lt;- averageABV</p> <p>colSums(is.na(average_beer))</p> <p>## Beer Beer_ID ABV IBU Brewery_id Style Ounces</p> <p>## 0 0 0 0 0 0 0</p> <p>## abb Brewery City State</p> <p>## 0 0 0 8</p> <p>#create Boxplot</p> <p>summary(average_beer$ABV)</p> <p>## Min. 1st Qu. Median Mean 3rd Qu. Max.</p> <p>## 0.00100 0.05000 0.05700 0.05977 0.06700 0.12800</p> <p>ggplot(data = average_beer, mapping = aes(x = ABV)) +</p> <p>` `geom_boxplot(fill = “red”, width=.1) +</p> <p>` `labs(x = “ABV”, title = “ABV Distribution”) +</p> <p>` `theme(axis.text.y=element_text(colour=”white”))</p> <h2 id="4-compute-the-median-alcohol-content-and-international-bitterness-unit-for-each-state-plot-a-bar-chart-to-compare">4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.</h2> <p>The code used to answer this question first creates a variable that stores the median ABV for each state. Then, a bar graph is created to visualize the information. The same is done for the median IBU.</p> <p><strong>Summary:</strong></p> <p>Alcohol content (ABV):</p> <ul> <li>Mean of all state ABV medians: 5.6%</li> <li>Kentucky has the highest ABV median: 6.25%</li> <li>Utah has the lowest ABV median: 4%</li> </ul> <p>Bitterness (IBU):</p> <ul> <li>Mean of all state IBU medians: 36.98</li> <li>Maine has the highest IBU median: 61</li> <li>Wisconsin has the lowest IBU median: 19</li> <li>South Dakota does not have IBU data for its beers</li> </ul> <p># Calculate median ABV by state, remove NA row in State</p> <p>medABV &lt;- bb %&gt;%</p> <p>` `group_by(State) %&gt;%</p> <p>` `filter(!is.na(ABV)) %&gt;%</p> <p>` `filter(!is.na(State)) %&gt;%</p> <p>` `summarize(medianABV = median(ABV))</p> <p>mean_median_abv &lt;- mean(medABV$medianABV)</p> <p># Plot median ABV</p> <p>ggplot(data= medABV, mapping = aes(x=State, y=medianABV, fill=State)) +</p> <p>` `geom_col() +</p> <p>` `theme(axis.text.x = element_text(angle=90,hjust=0.95,vjust=0.2),</p> <p>` `axis.title.x = element_blank(),</p> <p>` `axis.title.y = element_blank(),</p> <p>` `legend.position = “none”,</p> <p>` `panel.grid.major.y = element_line(color= “grey”),</p> <p>` `panel.grid.major.x = element_blank(),</p> <p>` `panel.grid.minor.x = element_blank(),</p> <p>` `panel.grid.minor.y = element_line(color=”grey”),</p> <p>` `panel.background = element_blank()) +</p> <p>` `scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +</p> <p>` `#expand_limits(y=c(0.03, 0.08)) +</p> <p>` `labs(title=”Median ABV Percentage of Beers by State”) +</p> <p>` `geom_hline(yintercept = mean_median_abv, color = “black”, linetype=”dashed”)</p> <p># Calculate median IBU by state</p> <p>medIBU &lt;- bb %&gt;%</p> <p>` `group_by(State) %&gt;%</p> <p>` `filter(!is.na(IBU)) %&gt;%</p> <p>` `filter(!is.na(State)) %&gt;%</p> <p>` `summarize(medianIBU = median(IBU))</p> <p># Where is South Dakota?</p> <p># bb %&gt;% filter(abb==”SD”)</p> <p># Beers in SD do not have corresponding IBU</p> <p>mean_median_IBU &lt;- mean(medIBU$medianIBU)</p> <p># Plot median IBU by state</p> <p>ggplot(data= medIBU, mapping = aes(x=State, y=medianIBU, fill=State)) +</p> <p>` `geom_col() +</p> <p>` `theme(axis.text.x = element_text(angle=90,hjust=0.95,vjust=0.2),</p> <p>` `axis.title.x = element_blank(),</p> <p>` `axis.title.y = element_blank(),</p> <p>` `legend.position = “none”,</p> <p>` `panel.grid.major.y = element_line(color=”grey”),</p> <p>` `panel.grid.major.x = element_blank(),</p> <p>` `panel.grid.minor.x = element_blank(),</p> <p>` `panel.grid.minor.y = element_line(color=”grey”),</p> <p>` `panel.background = element_blank()) +</p> <p>` `labs(title=”Median IBU of Beers by State”) +</p> <p>` `geom_hline(yintercept = mean_median_IBU, color = “black”, linetype=”dashed”)</p> <p># Reorder the levels of the State variable based on median ABV</p> <p>medABV$State &lt;- factor(medABV$State, levels = medABV$State[order(medABV$medianABV,</p> <p>` `decreasing = TRUE)])</p> <p>medABV50 &lt;- medABV[-c(51), ] # Remove row where State is NA</p> <p># Create the median ABV plot with ordered bars</p> <p>ggplot(medABV50, aes(x = State, y = medianABV, fill = State)) +</p> <p>` `geom_bar(stat = “identity”) +</p> <p>` `labs(title = “Median ABV (Percent) of Craft Beers by State”) +</p> <p>` `theme(axis.text.x = element_text(angle = 90, hjust = .95, vjust = 0.2),</p> <p>` `axis.title.x = element_blank(),</p> <p>` `axis.title.y = element_blank(),</p> <p>` `legend.position = “none”,</p> <p>` `panel.grid.major.y = element_line(color=”grey”),</p> <p>` `panel.grid.major.x = element_blank(),</p> <p>` `panel.grid.minor.x = element_blank(),</p> <p>` `panel.grid.minor.y = element_line(color=”grey”),</p> <p>` `panel.background = element_blank()) +</p> <p>` `scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +</p> <p>` `geom_hline(yintercept = mean_median_abv, color = “black”, linetype=”dashed”)</p> <p># Reorder the levels of the State variable based on median IBU</p> <p>medIBU$State &lt;- factor(medIBU$State, levels = medIBU$State[order(medIBU$medianIBU,</p> <p>` `decreasing = TRUE)])</p> <p># South Dakota is not on here because beers in SD do not have corresponding IBU</p> <p>ggplot(data= medIBU, mapping = aes(x=State, y=medianIBU, fill=State)) +</p> <p>` `geom_col() +</p> <p>` `theme(axis.text.x = element_text(angle=90,hjust=0.95,vjust=0.2),</p> <p>` `axis.title.x = element_blank(),</p> <p>` `axis.title.y = element_blank(),</p> <p>` `legend.position = “none”,</p> <p>` `panel.grid.major.y = element_line(color=”grey”),</p> <p>` `panel.grid.major.x = element_blank(),</p> <p>` `panel.grid.minor.x = element_blank(),</p> <p>` `panel.grid.minor.y = element_line(color=”grey”),</p> <p>` `panel.background = element_blank()) +</p> <p>` `labs(title=”Median IBU of Beers by State”) +</p> <p>` `geom_hline(yintercept = mean_median_IBU, color = “black”, linetype=”dashed”)</p> <h2 id="5-which-state-has-the-maximum-alcoholic-abv-beer-which-state-has-the-most-bitter-ibu-beer">5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?</h2> <p>The code used to answer this question simply determines which state has the maximum value in the ABV and IBU column.</p> <p><strong>Summary:</strong></p> <ul> <li>Highest ABV: Lee Hill Series Ale (12.8%) made by Upslope Brewing Company – Colorado</li> <li>Most bitter: Bitter Bitch Imperial IPA (138) made by Astoria Brewing Company – Oregon</li> </ul> <p># Find the state with the maximum alcoholic (IBU) beer</p> <p>state_with_max_IBU &lt;- bb[which.max(bb$IBU), “State”]</p> <p>bb[which.max(bb$IBU),]</p> <p>## Beer Beer_ID ABV IBU Brewery_id</p> <p>## 148 Bitter Bitch Imperial IPA 980 0.082 138 375</p> <p>## Style Ounces abb Brewery City</p> <p>## 148 American Double / Imperial IPA 12 OR Astoria Brewing Company Astoria</p> <p>## State</p> <p>## 148 Oregon</p> <p># Find the state with the maximum alcoholic (ABV) beer</p> <p>state_with_max_abv &lt;- bb[which.max(bb$ABV), “State”]</p> <p>bb[which.max(bb$ABV),]</p> <p>## Beer Beer_ID ABV IBU</p> <p>## 2279 Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale 2565 0.128 NA</p> <p>## Brewery_id Style Ounces abb Brewery City</p> <p>## 2279 52 Quadrupel (Quad) 19.2 CO Upslope Brewing Company Boulder</p> <p>## State</p> <p>## 2279 Colorado</p> <h2 id="6-comment-on-the-summary-statistics-and-distribution-of-the-abv-variable">6. Comment on the summary statistics and distribution of the ABV variable.</h2> <p>The code used to answer this question first summarizes the ABV column and then uses a boxplot to visualize the spread of values. A histogram is also included and shows right-skewedness.</p> <p><strong>Summary:</strong></p> <ul> <li>A boxplot is used to show the spread of the ABV variable <ul> <li>Minimum is 0.1% (a beer from California)</li> <li>Maximum is 12.8% (a beer from Colorado)</li> <li>Mean is 5.977%</li> </ul> </li> </ul> <p># Summary statistics of ABV variable</p> <p>bb$ABVpercent &lt;- bb$ABV*100</p> <p>summary(bb$ABVpercent)</p> <p>## Min. 1st Qu. Median Mean 3rd Qu. Max. NA’s</p> <p>## 0.100 5.000 5.600 5.977 6.700 12.800 62</p> <p># Create box plot</p> <p>ggplot(data = bb, mapping = aes(x = ABV * 100)) +</p> <p>` `geom_boxplot(fill = “red”, width=.1) +</p> <p>` `labs(x = “ABV”, title = “ABV Distribution”) +</p> <p>` `theme(axis.text.y=element_text(colour=”white”))</p> <p># Distribution of ABV variable</p> <p>ggplot(data = bb, mapping = aes(x = ABV * 100)) +</p> <p>` `geom_histogram(fill= “blue”, width=.1) +</p> <p>` `labs(x = “ABV %”,y = “Count”, title = “ABV Distribution”)</p> <p>## <code class="language-plaintext highlighter-rouge">stat\_bin()</code> using <code class="language-plaintext highlighter-rouge">bins = 30</code>. Pick better value with <code class="language-plaintext highlighter-rouge">binwidth</code>.</p> <h2 id="7-is-there-an-apparent-relationship-between-the-bitterness-of-the-beer-and-its-alcoholic-content-draw-a-scatter-plot-make-your-best-judgment-of-a-relationship-and-explain-your-answer">7. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot. Make your best judgment of a relationship and EXPLAIN your answer.</h2> <p>The code used to answer this question creates a scatterpolt where the x-axis is IBU and the y-axis is ABV.</p> <p><strong>Summary:</strong></p> <ul> <li>Visually, it looks like there is some positive relationship between IBU and ABV <ul> <li>As IBU increases, ABV tends to also increase</li> </ul> </li> </ul> <p>ggplot(data = beers, mapping = aes(x=IBU, y=ABV)) +</p> <p>` `geom_count(aes(color = ..n..), alpha=.5) +</p> <p>` `geom_smooth() +</p> <p>` `scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +</p> <p>` `theme(panel.grid.major.y = element_line(color=”grey”),</p> <p>` `panel.grid.major.x = element_blank(),</p> <p>` `panel.grid.minor.x = element_line(color=”grey”),</p> <p>` `panel.grid.minor.y = element_line(color=”grey”),</p> <p>` `panel.background = element_blank()) +</p> <p>` `scale_color_gradient(low = “red”, high =”navy”) +</p> <p>` `labs(title=”Alcohol Content (ABV) and Bitterness (IBU) of Beers”,</p> <p>` `colour=”Number of Beers”) +</p> <p>` `guides(color = guide_legend(override.aes = list(size = c(2, 4, 6, 8))),</p> <p>` `size = “none”)</p> <p>## <code class="language-plaintext highlighter-rouge">geom\_smooth()</code> using method = ‘gam’ and formula = ‘y ~ s(x, bs = “cs”)’</p> <h2 id="8-budweiser-would-also-like-to-investigate-the-difference-with-respect-to-ibu-and-abv-between-ipas-india-pale-ales-and-other-types-of-ale-any-beer-with-ale-in-its-name-other-than-ipa">8. Budweiser would also like to investigate the difference with respect to IBU and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with “Ale” in its name other than IPA).</h2> <h4 id="you-decide-to-use-knn-classification-to-investigate-this-relationship-provide-statistical-evidence-one-way-or-the-other-you-can-of-course-assume-your-audience-is-comfortable-with-percentages--knn-is-very-easy-to-understand-conceptually-in-addition-while-you-have-decided-to-use-knn-to-investigate-this-relationship-knn-is-required-you-may-also-feel-free-to-supplement-your-response-to-this-question-with-any-other-methods-or-techniques-you-have-learned-creativity-and-alternative-solutions-are-always-encouraged">You decide to use KNN classification to investigate this relationship. Provide statistical evidence one way or the other. You can of course assume your audience is comfortable with percentages … KNN is very easy to understand conceptually. In addition, while you have decided to use KNN to investigate this relationship (KNN is required) you may also feel free to supplement your response to this question with any other methods or techniques you have learned. Creativity and alternative solutions are always encouraged.</h4> <p>Transform data to analyze in Test 1:</p> <p>IPA &lt;- bb %&gt;%</p> <p>` `filter(str_detect(Style, “IPA”))</p> <p>ale &lt;- bb %&gt;%</p> <p>` `filter(str_detect(Style,”Ale”))</p> <p># Some IPAs are still in the ale variable; need to remove</p> <p>other_ales &lt;- ale[!str_detect(ale$Style, “\bIPA\b”), ]</p> <p># Dataset that includes both IPAs and other ales only</p> <table> <tbody> <tr> <td>allAles &lt;- bb[str_detect(bb$Style, “\bIPA\b”)</td> <td>str_detect(bb$Style, “\bAle\b”), ]</td> </tr> </tbody> </table> <p>allAles_complete &lt;- allAles[complete.cases(allAles$ABVpercent), ]</p> <p># Create a column Is_IPA</p> <p>allAles_complete$Is_IPA &lt;- ifelse(str_detect(allAles_complete$Style, “\bIPA\b”), “IPA”, “Other Ale”)</p> <h4 id="test-1-if-a-beer-has-an-abv-of-56-median-abv-across-all-states-what-are-the-chances-that-it-is-an-ipa">Test 1: If a beer has an ABV of 5.6% (median ABV across all states), what are the chances that it is an IPA?</h4> <p>The code used to explore this question first creates training and split set to be used in the knn model. Then, knn models are run.</p> <p><strong>Summary:</strong></p> <ul> <li>Created a dataset that includes ales <strong>only</strong> (both IPAs and other ales) <ul> <li>Created a training set and a test set with an 80/20 split</li> </ul> </li> <li>Using knn where k=3 and k=5, there is less than a 6% chance that the beer is an IPA (94.11% probability that it is another ale)</li> </ul> <p>set.seed(6)</p> <p>splitPerc = .8</p> <p># Split into training and test sets</p> <p>trainInd = sample(1:dim(allAles_complete)[1],round(splitPerc * dim(allAles_complete)[1]))</p> <p>allAlesTrain = allAles_complete[trainInd,]</p> <p>allAlesTest = allAles_complete[-trainInd,]</p> <p>abvTest5 &lt;- data.frame(ABVpercent = 5.6)</p> <p>knn(allAlesTrain[,”ABVpercent”], abvTest5, allAlesTrain$Is_IPA, prob = TRUE, k = 3)</p> <p>## [1] Other Ale</p> <p>## attr(,”prob”)</p> <p>## [1] 0.9411765</p> <p>## Levels: IPA Other Ale</p> <p>knn(allAlesTrain[,”ABVpercent”], abvTest5, allAlesTrain$Is_IPA, prob = TRUE, k = 5)</p> <p>## [1] Other Ale</p> <p>## attr(,”prob”)</p> <p>## [1] 0.9411765</p> <p>## Levels: IPA Other Ale</p> <h4 id="test-2-across-all-beer-styles-ipas-other-ales-and-other-which-knn-model-has-the-most-accuracy">Test 2: Across all beer styles (IPAs, other ales, and other), which knn model has the most accuracy?</h4> <p>The code used to explore this question uses the data set where the missing values are replaced with the medians. Then, a knn model is run for where k=1 to k=100. The data set used in this code includes IPAs, other ales, and other beer styles.</p> <p><strong>Summary:</strong></p> <ul> <li>k=5 is the most accurate; where k= 5… <ul> <li>Accuracy is 52.29%</li> <li>Of the other ales, 39.56% were incorrectly classified</li> <li>Of the IPAS, 39.1% were incorrectly classified</li> <li>Of the other types of beers (neither ale nor IPA), 61.71% were incorrectly classified</li> </ul> </li> </ul> <p># Classify IPAs and Ales</p> <p>beertypes = ifelse(str_detect(bb$Style,”IPA”)==TRUE,”IPA”,ifelse(str_detect(bb$Style,”Ale”)==TRUE,”ALE”,”Other”))</p> <p>bb$Type &lt;- beertypes</p> <p>head(bb)</p> <p>## Beer Beer_ID ABV IBU Brewery_id</p> <p>## 1 Pub Beer 1436 0.050 NA 409</p> <p>## 2 Devil’s Cup 2265 0.066 NA 178</p> <p>## 3 Rise of the Phoenix 2264 0.071 NA 178</p> <p>## 4 Sinister 2263 0.090 NA 178</p> <p>## 5 Sex and Candy 2262 0.075 NA 178</p> <p>## 6 Black Exodus 2261 0.077 NA 178</p> <p>## Style Ounces abb Brewery City</p> <p>## 1 American Pale Lager 12 OR 10 Barrel Brewing Company Bend</p> <p>## 2 American Pale Ale (APA) 12 IN 18th Street Brewery Gary</p> <p>## 3 American IPA 12 IN 18th Street Brewery Gary</p> <p>## 4 American Double / Imperial IPA 12 IN 18th Street Brewery Gary</p> <p>## 5 American IPA 12 IN 18th Street Brewery Gary</p> <p>## 6 Oatmeal Stout 12 IN 18th Street Brewery Gary</p> <p>## State ABVpercent Type</p> <p>## 1 Oregon 5.0 Other</p> <p>## 2 Indiana 6.6 ALE</p> <p>## 3 Indiana 7.1 IPA</p> <p>## 4 Indiana 9.0 IPA</p> <p>## 5 Indiana 7.5 IPA</p> <p>## 6 Indiana 7.7 Other</p> <p># Impute missing values with median</p> <p>bbimpute &lt;- bb</p> <p>bbimpute$IBU[is.na(bbimpute$IBU)]&lt;- median(bbimpute$IBU, na.rm = TRUE)</p> <p>bbimpute$ABV[is.na(bbimpute$ABV)]&lt;- median(bbimpute$ABV, na.rm = TRUE)</p> <p>bbimpute$ABVpercent[is.na(bbimpute$ABVpercent)]&lt;- median(bbimpute$ABVpercent, na.rm = TRUE)</p> <p>bbimpute = bbimpute[complete.cases(bbimpute),]</p> <p># Create a Data set for ABV, IBU, and Type</p> <p>btrain = bbimpute %&gt;% select(c(“ABV”,”IBU”,”Type”))</p> <p># Create kNN for k</p> <p>set.seed(100)</p> <p>iterations = 100</p> <p>numks = 10</p> <p>splitPerc = .70</p> <p>masterAcc = matrix(nrow = iterations, ncol = numks)</p> <p>for(j in 1:iterations)</p> <p>{</p> <p>` `trainIndices = sample(1:dim(btrain)[1],round(splitPerc * dim(btrain)[1]))</p> <p>` `train = btrain[trainIndices,]</p> <p>` `test = btrain[-trainIndices,]</p> <p>` `for(i in 1:numks)</p> <p>` `{</p> <p>` `classifications = knn(train[,c(1,2)],test[,c(1,2)],train$Type, prob = TRUE, k = i)</p> <p>` `table(classifications,test$Type)</p> <p>` `CM = confusionMatrix(table(classifications,test$Type))</p> <p>` `masterAcc[j,i] = CM$overall[1]</p> <p>` `}</p> <p>}</p> <p>CM</p> <p>## Confusion Matrix and Statistics</p> <p>##</p> <p>##</p> <p>## classifications ALE IPA Other</p> <p>## ALE 168 53 140</p> <p>## IPA 15 97 22</p> <p>## Other 90 29 107</p> <p>##</p> <p>## Overall Statistics</p> <p>##</p> <p>## Accuracy : 0.516</p> <p>## 95% CI : (0.4788, 0.553)</p> <p>## No Information Rate : 0.3786</p> <p>## P-Value [Acc &gt; NIR] : 4.968e-14</p> <p>##</p> <p>## Kappa : 0.2522</p> <p>##</p> <p>## Mcnemar’s Test P-Value : 3.120e-07</p> <p>##</p> <p>## Statistics by Class:</p> <p>##</p> <p>## Class: ALE Class: IPA Class: Other</p> <p>## Sensitivity 0.6154 0.5419 0.3978</p> <p>## Specificity 0.5692 0.9317 0.7367</p> <p>## Pos Pred Value 0.4654 0.7239 0.4735</p> <p>## Neg Pred Value 0.7083 0.8603 0.6727</p> <p>## Prevalence 0.3786 0.2483 0.3731</p> <p>## Detection Rate 0.2330 0.1345 0.1484</p> <p>## Detection Prevalence 0.5007 0.1859 0.3135</p> <p>## Balanced Accuracy 0.5923 0.7368 0.5672</p> <p>MeanAcc = colMeans(masterAcc)</p> <p>plot(seq(1,numks,1),MeanAcc, type = “l”)</p> <p>which.max(MeanAcc)</p> <p>## [1] 1</p> <p>max(MeanAcc)</p> <p>## [1] 0.5413731</p> <p>classifications = knn(train[,c(1,2)],test[,c(1,2)],train$Type, prob = TRUE, k = 5)</p> <p>table(classifications,test$Type)</p> <p>##</p> <p>## classifications ALE IPA Other</p> <p>## ALE 165 41 147</p> <p>## IPA 15 109 19</p> <p>## Other 93 29 103</p> <p>CM = confusionMatrix(table(classifications,test$Type))</p> <p>CM</p> <p>## Confusion Matrix and Statistics</p> <p>##</p> <p>##</p> <p>## classifications ALE IPA Other</p> <p>## ALE 165 41 147</p> <p>## IPA 15 109 19</p> <p>## Other 93 29 103</p> <p>##</p> <p>## Overall Statistics</p> <p>##</p> <p>## Accuracy : 0.5229</p> <p>## 95% CI : (0.4857, 0.5599)</p> <p>## No Information Rate : 0.3786</p> <p>## P-Value [Acc &gt; NIR] : 2.736e-15</p> <p>##</p> <p>## Kappa : 0.2648</p> <p>##</p> <p>## Mcnemar’s Test P-Value : 8.234e-06</p> <p>##</p> <p>## Statistics by Class:</p> <p>##</p> <p>## Class: ALE Class: IPA Class: Other</p> <p>## Sensitivity 0.6044 0.6089 0.3829</p> <p>## Specificity 0.5804 0.9373 0.7301</p> <p>## Pos Pred Value 0.4674 0.7622 0.4578</p> <p>## Neg Pred Value 0.7065 0.8789 0.6653</p> <p>## Prevalence 0.3786 0.2483 0.3731</p> <p>## Detection Rate 0.2288 0.1512 0.1429</p> <p>## Detection Prevalence 0.4896 0.1983 0.3121</p> <p>## Balanced Accuracy 0.5924 0.7731 0.5565</p> <h4 id="general-comparisons-of-the-different-beers-styles-ipas-other-ales-and-other">General comparisons of the different beers styles (IPAs, other ales, and other).</h4> <p>The code used in this section creates visualizations across the different beer styles: IPAs, other ales, and other beers. The first scatterplot graphs IBU and ABV by beer style; missing values were not included in this plot. The second scatterplot graphs the same information but replaces the missing values with medians. The box plot visualizes the spread of the IBU based on beer type.</p> <p><strong>Summary:</strong></p> <ul> <li>Generally, IPAs have higher ABV and IBU than other beers <ul> <li>Visually there looks to be a steeper positive relationship between ABV and IBU than the other types of beers</li> </ul> </li> <li>Other beer styles (neither IPA or another ale) generally have less than 50 IBUs</li> </ul> <p># Create Plot of IBU vs ABV, between different beer types</p> <p>bb %&gt;% ggplot(aes(x = ABV, y = IBU, color=Type)) +</p> <p>` `geom_point() +</p> <p>` `stat_ellipse() +</p> <p>` `labs(title=”IBU and ABV of Different Beer Styles”,</p> <p>` `subtitle=”Across IPAs, other ales, and other beers”)</p> <p># Impute missing values with median</p> <p>bbimpute &lt;- bb</p> <p>bbimpute$IBU[is.na(bbimpute$IBU)]&lt;- median(bbimpute$IBU, na.rm = TRUE)</p> <p>bbimpute$ABV[is.na(bbimpute$ABV)]&lt;- median(bbimpute$ABV, na.rm = TRUE)</p> <p>bbimpute$ABVpercent[is.na(bbimpute$ABVpercent)]&lt;- median(bbimpute$ABVpercent, na.rm = TRUE)</p> <p>bbimpute = bbimpute[complete.cases(bbimpute),]</p> <p># Create plot</p> <p>bbimpute %&gt;% ggplot(aes(x = ABV, y = IBU, color=Type)) + geom_point() + stat_ellipse()</p> <p># Boxplot of IBU across different beers</p> <p>ggplot(data=btrain, mapping=aes(x =Type , y = IBU)) +</p> <p>` `geom_boxplot() +</p> <p>` `labs(title=”Distribution of IBU across Different Beer Styles”,</p> <p>` `subtitle=”Across IPAs, other ales, and other beer styles”)</p> </body></html>